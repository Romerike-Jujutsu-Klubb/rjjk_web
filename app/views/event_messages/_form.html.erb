<% @content_width = 800 %>
<%= render :partial => '/tiny_mce' %>

<%= form_for(@event_message) do |f| %>
  <% if @event_message.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@event_message.errors.count, "error") %> prohibited this event_message from being saved:</h2>

      <ul>
      <% @event_message.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

    <div class="field">
      <%= f.label :hendelse %>:
      <%= f.hidden_field :event_id %>
      <%= f.hidden_field :message_type %>
      <%= @event_message.event.name %>
    </div>
    <div class="field">
      <%= f.label :meldingstype %>:
      <% if @event_message.message_type %>
          <%= @event_message.message_type %>
          <%= f.hidden_field :message_type %>
      <% else %>
          <%= f.select :message_type, [nil] + EventMessage::MessageType.constants.sort %>
      <% end %>
    </div>
  <div class="field">
    <%= f.label :subject %><br />
    <%= f.text_field :subject, :size => 64 %>
  </div>
  <div class="field">
    <%= f.label :body %><br />
    <%= f.text_area :body, :class => 'tiny_mce', :rows => 36 %>
  </div>
    <div class="field">
      <%= f.label :klar %>:
      <%= f.check_box :ready_at, {}, Time.now, nil %>
    </div>
  <div class="actions">
    <%= f.submit %>
    <%= back_or_link_to 'Tilbake', event_messages_path %>
    <%= link_to 'Vis', @event_message if @event_message.id %>
  </div>
<% end %>

.header
  - if flash[:notice]
    .fixed-bottom.mx-3.text-left style='position: absolute;font-size:1rem;line-height:1.5'
      .alert.alert-warning.alert-dismissible.fade.show role="alert"
        button.close type="button" data-dismiss="alert" aria-label="Close"
          span aria-hidden="true" &times;
        = textalize flash[:notice]
  i#navBtn.fa.fa-navicon.btn.btn-secondary.my-2.mx-1.mx-sm-2.float-left.d-xl-none
  i#calendarBtn.fa.fa-calendar.btn.btn-secondary.my-2.mx-1.mx-sm-2.float-left.d-lg-none

  .d-none.d-md-block.mt-md-5.mb-1 Romerike Jujutsu Klubb

  .fb-buttons
    = link_to 'http://www.facebook.com/home.php#!/pages/Romerike-Jujutsu-Klubb/260684570923?ref=ts', target: 'facebook'
      i.fa.fa-facebook.btn.btn-secondary.my-2.mx-1.mx-sm-2.my-md-0
    - if user?
      = link_to 'https://www.facebook.com/groups/romerikejjk', target: 'facebook'
        i.fa.fa-facebook-square.btn.btn-secondary.my-2.mx-1.mx-sm-2.my-md-0>
    - unless current_user&.member
      = link_to 'Pr√∏v oss', 'http://nkfwww.kampsport.no/portal/page/portal/ks_utv/ks_bli_medlem?p_o3_pk_id=162', class: 'btn btn-secondary my-2 mx-1 mx-sm-2', target: 'NKF'

css:
  .moving {
    transition: transform 0ms !important;
  }

javascript:
    $('#navBtn').on('click', function () {
        console.log('menu clicked');
        $('.subnav').css('transform', 'translate(0px, 0)');
        $('#menuShadow').css('transition', 'visibility 0s, opacity 0.5s');
        $('#menuShadow').css('visibility', 'visible').css('opacity', '0.5');
        $("body").addClass("modal-open");
    });
    $('#calendarBtn').on('click', function () {
        console.log('calendar clicked');
        $('.main_right').css('transform', 'translate(0px, 0)');
        $('#sidebarShadow').css('transition', 'visibility 0s, opacity 0.5s');
        $('#sidebarShadow').css('visibility', 'visible').css('opacity', '0.5');
        $("body").addClass("modal-open");
    });

    $('.shadow').on('click', function () {
        console.log('shadow clicked');
        $('.subnav').css('transform', 'translate(-268px, 0)');
        $('.main_right').css('transform', 'translate(268px, 0)');
        $('.shadow').css('opacity', '0');
        $('.shadow').css('transition', 'visibility 0.5s, opacity 0.5s');
        $('.shadow').css('visibility', 'hidden');
        $("body").removeClass("modal-open")
    });

    function menu_slider($menu) {
        var currTrans = $menu.css('-webkit-transform').split(/[()]/)[1];
        var posx = currTrans.split(',')[4];
        var slider = {
            menu: $menu,
            slideWidth: $menu.width(),
            dir: posx / Math.abs(posx),
            touchstartx: undefined,
            touchstarty: undefined,
            touchmovex: undefined,
            touchmovey: undefined,
            movex: undefined,
            movey: undefined,
            longTouch: undefined,

            start: function (event) {
                // Test for flick.
                this.longTouch = false;
                setTimeout(function () {
                    slider.longTouch = true;
                }, 250);

                // Get the original touch position.
                this.touchstartx = event.originalEvent.touches[0].pageX;
                this.touchstarty = event.originalEvent.touches[0].pageY;

                // The movement gets all janky if there's a transition on the elements.
                this.menu.addClass('moving');
            },

            move: function (event) {
                // Continuously return touch position.
                this.touchmovex = event.originalEvent.touches[0].pageX;
                this.touchmovey = event.originalEvent.touches[0].pageY;
                // Calculate distance to translate holder.
                this.movex = this.touchmovex - this.touchstartx;
                this.movey = this.touchmovey - this.touchstarty;
                if (this.movex * this.dir < 0 || Math.abs(this.movey) > Math.abs(this.movex) ) {
                    // Makes the holder stop moving when there is no more content.
                    this.movex = 0;
                }
                this.menu.css('transform', 'translate3d(' + this.movex + 'px,0,0)');
            },

            end: function (event) {
                // Move and animate the elements.
                this.menu.removeClass('moving');

                // Calculate the distance swiped.
                var absMove = Math.abs(this.movex);
                if ((Math.abs(this.movey) <= Math.abs(this.movex)) && (absMove > this.slideWidth / 2 || (absMove > 0 && this.longTouch === false))) {
                    $('.shadow').trigger('click');
                } else {
                    this.menu.css('transform', 'translate(0px, 0)');
                }
            }
        };
        $menu.on("touchstart", function (event) {
            slider.start(event);
        });

        $menu.on("touchmove", function (event) {
            slider.move(event);
        });

        $menu.on("touchend", function (event) {
            slider.end(event);
        });
        return slider;
    }

    $(function () {
        menu_slider($(".subnav"));
        menu_slider($(".main_right"));
    });

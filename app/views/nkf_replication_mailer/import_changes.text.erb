NKF Import

Endringer fra NKF-portalen.

<% if @import.new_records.any? -%>
<%=@import.new_records.size %> medlemmer opprettet
<% end -%>
<% if @import.changes.any? -%>
<%=@import.changes.size %> medlemmer oppdatert
<% end -%>
<%="#{@import.error_records.size} feilet" if @import.error_records.any? %>

<% if @import.trial_changes.any? -%>
Endringer pr√∏vetid:
<% @import.trial_changes.each do |r| -%>
    <%= r[:record].fornavn %> <%= r[:record].etternavn %>:
        <%= r[:changes].inspect.html_safe %>
    <% end -%>

<% end -%>
<% if @import.new_records.any? -%>
Nye medlemmer:

<% @import.new_records.each do |r| -%>
    <%= r[:record].fornavn %> <%= r[:record].etternavn %>:
        <%= r[:record].attributes %>
<% end -%>

<% end -%>
<% if @import.changes.any? -%>
Endringer:

<% @import.changes.each do |r| -%>
    <%= r[:record].fornavn %> <%= r[:record].etternavn %>:
        <%= r[:changes].pretty_inspect.html_safe %>
<% end -%>

<% end -%>
<% if @import.error_records.any? -%>
Feil:
    <% @import.error_records.each do |r| -%>
    <%= r.class %> <%= r.id %> <%= r.errors.full_messages.inspect.html_safe %>
    <% end -%>
<% end -%>
<% if @import.exception -%>
Feil:
    <%= @import.exception.class %>
    <%= @import.exception.message.html_safe %>
    <%= @import.exception.backtrace.join("\n").html_safe %>
<% end -%>

<%= form_for(@election) do |f| %>
    <% if @election.errors.any? %>
        <div id="error_explanation">
          <h2><%= @election.errors.count %> feil forhindret lagring av valget:
          </h2>

          <ul>
            <% @election.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
    <% end %>

    <div class="form-group">
      <%= f.label :annual_meeting_id, 'Årsmøte' %>
      <%= f.select :annual_meeting_id, options_from_collection_for_select(@annual_meetings, :id, :date, @election.annual_meeting_id), {}, class: 'form-control' %>
    </div>
    <div class="form-group">
      <%= f.label :role_id, 'Stilling' %>
      <%= f.select :role_id, options_from_collection_for_select(@roles, :id, :name, @election.role_id),
              {prompt: 'Velg rolle'}, class: 'form-control' %>
    </div>

    <div class="form-group">
      <%= f.label :member_id, 'Medlem' %>
      <%= f.select :member_id, options_from_collection_for_select(@members, :id, :name, @election.member_id),
              {prompt: 'Velg medlem'}, class: 'form-control chosen-select' %>
    </div>
    <% if @election.member.try(:guardians).try(:any?) %>
        <div class="form-group">
          <%= f.label :guardian, 'Foresatt' %>
          <%= f.select :guardian,
                  [*@election.member.guardians.map { |i,g| ["#{g[:name]} (#{g[:email] || 'e-post mangler'})", i] }],
                  {include_blank: @election.guardian ? 'Ingen foresatt' : 'Velg foresatt hvis passende'},
                  class: 'form-control' %>
        </div>
    <% end %>

    <% unless @election.new_record? %>
        <div class="form-group">
          <%= f.label :resigned_on, 'Trukket seg' %>
          <%= f.text_field :resigned_on, class: 'date form-control' %>
        </div>
    <% end %>

    <div class="actions">
      <%= f.submit 'Lagre', class: 'btn btn-primary' %>
      <%= link_to 'Til styreoversikt', elections_path, class: 'btn btn-default' %>
    </div>
<% end %>

<% @content_width = 880 %>

/ #carouselIndicators.carousel.slide data-ride="carousel"
/   ol.carousel-indicators
/     li.active data-target="#carouselIndicators" data-slide-to="0"
/     li data-target="#carouselIndicators" data-slide-to="1"
/     li data-target="#carouselIndicators" data-slide-to="2"
/   .carousel-inner
/     .carousel-item.active
/       img.d-block.w-100 src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22800%22%20height%3D%22400%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20800%20400%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_1662a9849c1%20text%20%7B%20fill%3A%23555%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A40pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_1662a9849c1%22%3E%3Crect%20width%3D%22800%22%20height%3D%22400%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22285.921875%22%20y%3D%22218.45%22%3EFirst%20slide%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E" alt="First slide"
/     .carousel-item
/       img.d-block.w-100 src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22800%22%20height%3D%22400%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20800%20400%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_1662a9849c3%20text%20%7B%20fill%3A%23444%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A40pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_1662a9849c3%22%3E%3Crect%20width%3D%22800%22%20height%3D%22400%22%20fill%3D%22%23666%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22247.3203125%22%20y%3D%22218.45%22%3ESecond%20slide%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E" alt="Second slide"
/     .carousel-item
/       img.d-block.w-100 src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22800%22%20height%3D%22400%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20800%20400%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_1662a9849c3%20text%20%7B%20fill%3A%23333%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A40pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_1662a9849c3%22%3E%3Crect%20width%3D%22800%22%20height%3D%22400%22%20fill%3D%22%23555%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22277%22%20y%3D%22218.45%22%3EThird%20slide%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E" alt="Third slide"
/   a.carousel-control-prev href="#carouselIndicators" role="button" data-slide="prev"
/     span.carousel-control-prev-icon aria-hidden="true"
/     span.sr-only Previous
/   a.carousel-control-next href="#carouselIndicators" role="button" data-slide="next"
/     span.carousel-control-next-icon aria-hidden="true"
/     span.sr-only Next


<a class="carousel-control left" style="position: inherit; margin-top: -0.05em" href="<%= url_for :year => (@first_date - 1).year, :month => (@first_date - 1).month %>">&lsaquo;</a>
<a class="carousel-control right" style="position: inherit; margin-top: -0.05em" href="<%=url_for :year => (@last_date + 1).year, :month => (@last_date + 1).month%>">&rsaquo;</a>
<h2>Oppmøterapport <%= t(:date)[:month_names][@first_date.month] %> <%= @first_date.year %></h2>

<div id="myCarousel" class="carousel slide" data-interval="false">
  <!-- Carousel items -->
  <div class="carousel-inner">
    <div class="active item">
      <%= image_tag url_for(:controller => :attendances, :action => :month_chart, :year => @year, :month => @month, :size => '832x300', :format => :png),
                    :title => 'Oppmøte graf', :class => 'rounded', :style => 'width: 832px; height: 300px',
                    :usemap => '#monthmap' %>
    </div>
    <div class="item">
      <%= image_tag url_for(:controller => :attendances, :action => :month_per_year_chart, :month => @month, :size => '832x300', :format => :png),
                    :title => 'Oppmøte graf', :class => 'rounded', :style => 'width: 832px; height: 300px',
                    :usemap => '#monthmap' %>
    </div>
    <div class="item">
      <%= image_tag url_for(:controller => :attendances, :action => :history_graph, :id => '832x300', :format => :png),
                    :title => 'Oppmøte graf', :class => 'rounded', :style => 'width: 832px; height: 300px',
                    :usemap => '#monthmap' %>
    </div>
  </div>
  <!-- Carousel nav -->
  <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
  <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
</div>

<style>
    .carousel .carousel-control {
        visibility: hidden;
    }

    .carousel:hover .carousel-control {
        visibility: visible;
    }
</style>

<map name="monthmap">
  <!--
  <area shape="circle" coords="90,58,3" href="mercur.htm" alt="Mercury">
  <area shape="circle" coords="124,58,8" href="venus.htm" alt="Venus">
  -->
</map>

<table class="table">
  <% @monthly_summary_per_group.each do |g, stats| %>
      <tr>
        <th><%= g.name %></th>
        <td><%= stats[:present].size %></td>
        <td>Gjennomsnittlig <%= stats[:present].empty? ? 0 : (stats[:present].size.to_f / stats[:practices]).round %>
          deltakere på <%= stats[:practices] %> treninger
        </td>
      </tr>
  <% end %>
</table>

<h3>Antall deltakere</h3>

<table class="table">
  <tr>
    <th></th>
    <th style="text-align:center">Totalt</th>
    <th style="text-align:center">Tilstede +50%</th>
    <th style="text-align:center">Tilstede +67%</th>
  </tr>
  <% @by_group_and_member.each do |group, members| %>
      <tr>
        <th><%= group.name %></th>
        <td style="text-align:center"><%= members.select { |m, ats| true }.size %></td>
        <td style="text-align:center"><%= members.select { |m, ats| ats.size >= @monthly_summary_per_group[group][:practices] * 0.5 }.size %></td>
        <td style="text-align:center"><%= members.select { |m, ats| ats.size >= @monthly_summary_per_group[group][:practices] * 0.67 }.size %></td>
      </tr>
  <% end %>
</table>
